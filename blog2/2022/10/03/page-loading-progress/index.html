<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>详解输入URL到页面加载的全过程 | Alan的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="本章节是 Vue.js 源码分析系列的第三章节，主要介绍基础数据代理。

1. 在浏览器中输入URL
1.1 查找域名缓存
缓存顺序：「浏览器缓存-&gt;系统缓存-&gt;路由器缓存-&gt;ISP缓存」， 如果没有缓存，继续向ISP搜索。

1.2 DNS域名解析
浏览器向DNS服务器发起请求，解析该URL中的域名对应的IP地址。DNS服务器是基于UDP的 ...">
    
    <link rel="preload" href="/blog/assets/css/0.styles.ae7fb01b.css" as="style"><link rel="preload" href="/blog/assets/js/app.d377f9a8.js" as="script"><link rel="preload" href="/blog/assets/js/13.cdda75ce.js" as="script"><link rel="preload" href="/blog/assets/js/3.6e92e369.js" as="script"><link rel="preload" href="/blog/assets/js/23.24c6d75c.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d7440df3.js"><link rel="prefetch" href="/blog/assets/js/11.0f75d598.js"><link rel="prefetch" href="/blog/assets/js/12.e3dad924.js"><link rel="prefetch" href="/blog/assets/js/14.5505cb55.js"><link rel="prefetch" href="/blog/assets/js/15.53f28293.js"><link rel="prefetch" href="/blog/assets/js/16.e2112a01.js"><link rel="prefetch" href="/blog/assets/js/17.3382d02b.js"><link rel="prefetch" href="/blog/assets/js/18.652af8b8.js"><link rel="prefetch" href="/blog/assets/js/19.d92bcd2d.js"><link rel="prefetch" href="/blog/assets/js/20.0ca3e92e.js"><link rel="prefetch" href="/blog/assets/js/21.cf261eb8.js"><link rel="prefetch" href="/blog/assets/js/22.0274147f.js"><link rel="prefetch" href="/blog/assets/js/24.0c5253e1.js"><link rel="prefetch" href="/blog/assets/js/25.94c44222.js"><link rel="prefetch" href="/blog/assets/js/26.d02cc279.js"><link rel="prefetch" href="/blog/assets/js/27.e530fb61.js"><link rel="prefetch" href="/blog/assets/js/28.c7c2df58.js"><link rel="prefetch" href="/blog/assets/js/29.b900fe7b.js"><link rel="prefetch" href="/blog/assets/js/30.c0d9bf50.js"><link rel="prefetch" href="/blog/assets/js/31.4640e6c2.js"><link rel="prefetch" href="/blog/assets/js/32.65c578d1.js"><link rel="prefetch" href="/blog/assets/js/33.238f8484.js"><link rel="prefetch" href="/blog/assets/js/34.47fe14a6.js"><link rel="prefetch" href="/blog/assets/js/35.dd97b64b.js"><link rel="prefetch" href="/blog/assets/js/36.bbf2dc14.js"><link rel="prefetch" href="/blog/assets/js/37.cc9f13e1.js"><link rel="prefetch" href="/blog/assets/js/38.b4c2f687.js"><link rel="prefetch" href="/blog/assets/js/39.7fa52631.js"><link rel="prefetch" href="/blog/assets/js/4.3793fc68.js"><link rel="prefetch" href="/blog/assets/js/40.7124080e.js"><link rel="prefetch" href="/blog/assets/js/41.0dd5ac08.js"><link rel="prefetch" href="/blog/assets/js/42.e6135314.js"><link rel="prefetch" href="/blog/assets/js/43.3032bda2.js"><link rel="prefetch" href="/blog/assets/js/44.f7ffa396.js"><link rel="prefetch" href="/blog/assets/js/45.476f9d2c.js"><link rel="prefetch" href="/blog/assets/js/46.5b298dbb.js"><link rel="prefetch" href="/blog/assets/js/47.1db03b10.js"><link rel="prefetch" href="/blog/assets/js/48.b0f94012.js"><link rel="prefetch" href="/blog/assets/js/49.7a11fe37.js"><link rel="prefetch" href="/blog/assets/js/5.98ad11c8.js"><link rel="prefetch" href="/blog/assets/js/50.fdff941c.js"><link rel="prefetch" href="/blog/assets/js/51.9a40e885.js"><link rel="prefetch" href="/blog/assets/js/52.fa31a84c.js"><link rel="prefetch" href="/blog/assets/js/53.bd199e39.js"><link rel="prefetch" href="/blog/assets/js/54.54fc39f6.js"><link rel="prefetch" href="/blog/assets/js/6.b2fc444d.js"><link rel="prefetch" href="/blog/assets/js/7.b470cadf.js"><link rel="prefetch" href="/blog/assets/js/8.715a2d16.js"><link rel="prefetch" href="/blog/assets/js/9.50f121db.js"><link rel="prefetch" href="/blog/assets/js/vuejs-paginate.befbb007.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ae7fb01b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">Alan的博客 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/" class="nav-link">博客</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">标签</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">Alan的博客 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/" class="nav-link">博客</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">标签</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        详解输入URL到页面加载的全过程
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Alan</span> <span itemprop="address">   in Shanghai</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2022-10-03T00:00:00.000Z">
      Mon Oct 03 2022
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/页面加载" data-v-42ccfcd5><span data-v-42ccfcd5>页面加载</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/URL" data-v-42ccfcd5><span data-v-42ccfcd5>URL</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>本章节是 Vue.js 源码分析系列的第三章节，主要介绍基础数据代理。</p> <h2 id="_1-在浏览器中输入url"><a href="#_1-在浏览器中输入url" class="header-anchor">#</a> 1. 在浏览器中输入URL</h2> <h4 id="_1-1-查找域名缓存"><a href="#_1-1-查找域名缓存" class="header-anchor">#</a> 1.1 查找域名缓存</h4> <p>缓存顺序：「浏览器缓存-&gt;系统缓存-&gt;路由器缓存-&gt;ISP缓存」， 如果没有缓存，继续向ISP搜索。</p> <h4 id="_1-2-dns域名解析"><a href="#_1-2-dns域名解析" class="header-anchor">#</a> 1.2 DNS域名解析</h4> <p>浏览器向DNS服务器发起请求，解析该URL中的域名对应的IP地址。DNS服务器是基于UDP的，因此会用到UDP协议。</p> <h4 id="_1-3-建立tcp连接"><a href="#_1-3-建立tcp连接" class="header-anchor">#</a> 1.3 建立TCP连接</h4> <p>解析出IP地址后，根据IP地址和默认80端口，和服务器建立TCP连接</p> <h4 id="_1-4-发起http请求"><a href="#_1-4-发起http请求" class="header-anchor">#</a> 1.4 发起HTTP请求</h4> <p>浏览器发起读取文件的HTTP请求，该请求报文作为TCP三次握手的第三次数据发送给服务器</p> <h4 id="_1-5-服务器响应请求"><a href="#_1-5-服务器响应请求" class="header-anchor">#</a> 1.5 服务器响应请求</h4> <p>服务器对浏览器请求做出响应，并把对应的html文件发送给浏览器</p> <h4 id="_1-6-关闭tcp连接"><a href="#_1-6-关闭tcp连接" class="header-anchor">#</a> 1.6 关闭TCP连接</h4> <p>通过四次挥手释放TCP连接</p> <h2 id="_2-浏览器渲染"><a href="#_2-浏览器渲染" class="header-anchor">#</a> 2. 浏览器渲染</h2> <p>客户端（浏览器）解析HTML内容并渲染出来，浏览器接收到数据包后的解析流程为：</p> <h4 id="_2-1-构建dom树"><a href="#_2-1-构建dom树" class="header-anchor">#</a> 2.1 构建DOM树</h4> <p>词法分析然后解析成DOM树（dom tree），是由dom元素及属性节点组成，树的根是document对象</p> <h4 id="_2-2-构建css规则树"><a href="#_2-2-构建css规则树" class="header-anchor">#</a> 2.2 构建CSS规则树</h4> <p>生成CSS规则树（CSS Rule Tree）</p> <h4 id="_2-3-构建render树"><a href="#_2-3-构建render树" class="header-anchor">#</a> 2.3 构建render树</h4> <p>Web浏览器将DOM和CSSOM结合，并构建出渲染树（render tree）</p> <h4 id="_2-4-布局-layout"><a href="#_2-4-布局-layout" class="header-anchor">#</a> 2.4 布局（Layout）</h4> <p>计算出每个节点在屏幕中的位置</p> <h4 id="_2-5-绘制-painting"><a href="#_2-5-绘制-painting" class="header-anchor">#</a> 2.5 绘制（Painting）</h4> <p>即遍历render树，并使用UI后端层绘制每个节点
<img src="/blog/assets/img/159.eb624efe.png"></p> <h2 id="_3-js引擎解析过程"><a href="#_3-js引擎解析过程" class="header-anchor">#</a> 3. JS引擎解析过程</h2> <p>调用JS引擎执行JS代码（JS的解释阶段，预处理阶段，执行阶段生成执行上下文，VO，作用域链、回收机制等等）</p> <h4 id="_3-1-创建window对象"><a href="#_3-1-创建window对象" class="header-anchor">#</a> 3.1 创建window对象</h4> <p>window对象也叫全局执行环境，当页面产生时就被创建，所有的全局变量和函数都属于window的属性和方法，而DOM Tree也会映射在window的doucment对象上。当关闭网页或者关闭浏览器时，全局执行环境会被销毁。</p> <h4 id="_3-2-加载文件"><a href="#_3-2-加载文件" class="header-anchor">#</a> 3.2 加载文件</h4> <p>完成js引擎分析它的语法与词法是否合法，如果合法进入预编译</p> <h4 id="_3-3-预编译"><a href="#_3-3-预编译" class="header-anchor">#</a> 3.3 预编译</h4> <p>在预编译的过程中，浏览器会寻找全局变量声明，把它作为window的属性加入到window对象中，并给变量赋值为'undefined'；寻找全局函数声明，把它作为window的方法加入到window对象中，并将函数体赋值给他（匿名函数是不参与预编译的，因为它是变量）。而变量提升作为不合理的地方在ES6中已经解决了，函数提升还存在。</p> <h4 id="_3-4-解释执行"><a href="#_3-4-解释执行" class="header-anchor">#</a> 3.4 解释执行</h4> <p>执行到变量就赋值，如果变量没有被定义，也就没有被预编译直接赋值，在ES5非严格模式下这个变量会成为window的一个属性，也就是成为全局变量。string、int这样的值就是直接把值放在变量的存储空间里，object对象就是把指针指向变量的存储空间。函数执行，就将函数的环境推入一个环境的栈中，执行完成后再弹出，控制权交还给之前的环境。JS作用域其实就是这样的执行流机制实现的。</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#_1-在浏览器中输入url" title="1. 在浏览器中输入URL">1. 在浏览器中输入URL</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_2-浏览器渲染" title="2. 浏览器渲染">2. 浏览器渲染</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_3-js引擎解析过程" title="3. JS引擎解析过程">3. JS引擎解析过程</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.d377f9a8.js" defer></script><script src="/blog/assets/js/13.cdda75ce.js" defer></script><script src="/blog/assets/js/3.6e92e369.js" defer></script><script src="/blog/assets/js/23.24c6d75c.js" defer></script>
  </body>
</html>
