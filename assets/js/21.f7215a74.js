(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{584:function(t,s,a){t.exports=a.p+"assets/img/135.bc3b3119.png"},636:function(t,s,a){"use strict";a.r(s);var e=a(19),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("直接安装 vs 虚拟机 vs docker")]),t._v(" "),e("h2",{attrs:{id:"对比安装方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#对比安装方式"}},[t._v("#")]),t._v(" 对比安装方式")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("对比")]),t._v(" "),e("th",[t._v("直接安装")]),t._v(" "),e("th",[t._v("虚拟机")]),t._v(" "),e("th",[t._v("docker")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("优点")]),t._v(" "),e("td",[t._v("简单，直接")]),t._v(" "),e("td",[t._v("环境隔离")]),t._v(" "),e("td",[t._v("环境隔离，方便迁移")])]),t._v(" "),e("tr",[e("td",[t._v("缺点")]),t._v(" "),e("td",[t._v("污染全局环境，多版本情况不好处理")]),t._v(" "),e("td",[t._v("启动慢，资源占用多")]),t._v(" "),e("td",[t._v("-")])])])]),t._v(" "),e("h2",{attrs:{id:"概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),e("p",[t._v("image: 镜像，是一个只读版本，用来创建容器\ncontainer: 容器，是一个可运行的镜像实例\nDockerfile: 镜像构建的模版，描述镜像构建的步骤")]),t._v(" "),e("h2",{attrs:{id:"简单示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简单示例"}},[t._v("#")]),t._v(" 简单示例")]),t._v(" "),e("ul",[e("li",[t._v("1.代码文件")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** index.js */")]),t._v("\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("ul",[e("li",[t._v("2.获取node14.19.1镜像")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker pull node"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.19")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("slim\n")])])]),e("ul",[e("li",[t._v("3.Dockerfile")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** Dockerfile */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("node")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.19")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("slim    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取node版本镜像 https://hub.docker.com/_/node?tab=tags&page=1&name=14.19.1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("demo   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拷贝当前目录到demo目录")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WORKDIR")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("demo   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 进入demo目录")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CMD")]),t._v(" node index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行node index.js")]),t._v("\n")])])]),e("ul",[e("li",[t._v("4.构建镜像")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker image build "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t demo "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 构建镜像")]),t._v("\n$ docker image ls              "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查看镜像")]),t._v("\n$ docker container run demo   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行容器")]),t._v("\n")])])]),e("h2",{attrs:{id:"搭建开发环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搭建开发环境"}},[t._v("#")]),t._v(" 搭建开发环境")]),t._v(" "),e("p",[t._v("全局安装：node, git, typescript, uniapp")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("node")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.19")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("slim\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WORKDIR")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" apt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" apt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y git\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" npm install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g typescript @vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cli\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CMD")]),t._v(" npm run serve\n")])])]),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker image build "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 构建镜像")]),t._v("\n$ docker container run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行容器")]),t._v("\n")])])]),e("h3",{attrs:{id:"docker映射端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker映射端口"}},[t._v("#")]),t._v(" docker映射端口")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker container run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v(" vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//容器端口映射真实端口")]),t._v("\n")])])]),e("h3",{attrs:{id:"挂载点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#挂载点"}},[t._v("#")]),t._v(" 挂载点???")]),t._v(" "),e("p",[t._v("可以让容器访问本机的文件系统")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker container run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${pwd}:/vue3"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it vue"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n")])])]),e("h3",{attrs:{id:"vscode插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vscode插件"}},[t._v("#")]),t._v(" vscode插件")]),t._v(" "),e("p",[e("code",[t._v("Remote-Containers")]),t._v(" "),e("code",[t._v("Remote-SSH")])]),t._v(" "),e("h3",{attrs:{id:"所有开发用同一个镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#所有开发用同一个镜像"}},[t._v("#")]),t._v(" 所有开发用同一个镜像")]),t._v(" "),e("p",[t._v("方便复制环境，方便统一环境，方便随时随地远程工作")]),t._v(" "),e("p",[t._v("ps: 可以团队使用一个镜像，全部远程开发")]),t._v(" "),e("h2",{attrs:{id:"docker托管静态文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker托管静态文件"}},[t._v("#")]),t._v(" docker托管静态文件")]),t._v(" "),e("ul",[e("li",[t._v("配置docker配置文件")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** Dockerfile */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" nginx\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dist"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXPOSE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),e("ul",[e("li",[t._v("构造镜像")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker image build "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),t._v("\n")])])]),e("ul",[e("li",[t._v("运行容器")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建容器（容器端口映射）")]),t._v("\n$ docker container create "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3333")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成结果：18bcc90642d06e4eced9e928b14d83adda753200881b5c48cfce6c790826049a")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启动容器")]),t._v("\n$ docker container start 18bcc90642d06e4eced9e928b14d83adda753200881b5c48cfce6c790826049a\n\n")])])]),e("p",[t._v("在浏览器打开：http://localhost:3333")]),t._v(" "),e("h2",{attrs:{id:"迁移静态站点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#迁移静态站点"}},[t._v("#")]),t._v(" 迁移静态站点")]),t._v(" "),e("ul",[e("li",[t._v("Github中的CI "),e("a",{attrs:{href:"https://app.travis-ci.com/signup",target:"_blank",rel:"noopener noreferrer"}},[t._v("注册Travis CI"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("在项目根目录添加.travis.yml文件")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** .travis.yml */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("language")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" node_js\n"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("node_js")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" docker\n\n"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("before_install")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" npm install\n\n"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("script")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" npm run build\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" echo "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$DOCKER_PASSWORD"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" docker login "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$DOCKER_USERNAME"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stdin\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" docker build "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t alan89757"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("latest "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" docker push alan89757"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("latest\n\n")])])]),e("ul",[e("li",[e("p",[t._v("travis CI配置\n"),e("img",{attrs:{src:a(584)}})])]),t._v(" "),e("li",[e("p",[t._v("spa页面重定向,nginx配置如下")])])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("server "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  listen "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  server_name localhost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  location "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    root "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    index index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header Host $host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f $request_filename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      rewrite "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("$ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  error_page "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("50x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  location "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("50x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      root "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("ul",[e("li",[t._v("Dockerfile配置")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" nginx\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dist"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vhost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("conf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 读取nginx配置")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXPOSE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),e("ul",[e("li",[t._v("运行容器")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("docker image pull alan89757"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("latest\ndocker container create "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3333")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" alan89757"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("latest\ndocker container start xxx # xxx 为上一条命令执行的返回值\n")])])]),e("h2",{attrs:{id:"nginx反向代理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx反向代理"}},[t._v("#")]),t._v(" nginx反向代理")]),t._v(" "),e("p",[t._v("背景：目前我们将容器挂到了 3333 端口，但是线上不可能让用户手动输入 3333 端口进行访问。而如果将容器直接挂到 80 端口，虽然这样用户可以直接不加端口直接访问，但是如果有第二个容器，或者更多容器呢？\n这时候就需要在宿主机跑一个 Nginx，由它来独占 80 端口，然后根据域名来讲请求分发给响应的容器")]),t._v(" "),e("ul",[e("li",[t._v("登陆服务器安装nginx")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ apt update # 更新软件包\n$ apt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" install nginx # 安装 Nginx\n$ systemctl status nginx # 查看 Nginx 状态\n")])])]),e("ul",[e("li",[t._v("配置反向代理")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("server "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  listen "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  server_name pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  location "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8082")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"docker-compose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[t._v("#")]),t._v(" docker-compose")]),t._v(" "),e("ol",[e("li",[t._v("docker-compose 是 Docker 官方提供的一个 Docker 管理工具")]),t._v(" "),e("li",[t._v("docker-compose 会帮我们自动去拉镜像，创建容器，将容器中的80端口映射为宿主机的8082端口。restart字段还要求 docker-compose 当发现容器意外挂掉时重新启动容器，类似于 pm2，所以你不必再在容器内使用 pm2")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("help\n")])])]),e("ul",[e("li",[t._v("新建docker-compose.yml")])]),t._v(" "),e("div",{staticClass:"language-yml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.7"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个是配置文件的版本，不同的版本号声明方式会有细微的不同")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pea3nut/pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8082:80"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" on"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("failure\n")])])]),e("ul",[e("li",[t._v("启动服务\n"),e("code",[t._v("docker-compose up info")])])]),t._v(" "),e("h3",{attrs:{id:"创建新容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建新容器"}},[t._v("#")]),t._v(" 创建新容器")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("$ docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose pull info\n$ docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose stop info\n$ docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose rm info\n$ docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose up "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d info # "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d 代表后台运行\n")])])]),e("h2",{attrs:{id:"volume"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[t._v("#")]),t._v(" Volume")]),t._v(" "),e("ol",[e("li",[t._v("Volume可以将容器内和宿主机的某个文件夹进行”绑定“，任何文件改动都会得到同步。所以，我可以将整个站点目录和 MySQL 目录都挂载为 Volume。这样，当容器删除时，所有数据文件和源码都会保留")]),t._v(" "),e("li",[t._v("在本地建立./blog/mysql-data目录存储 MySQL 数据，建立./blog/wordpress目录存储 WordPress 源码。然后修改docker-compose.yml如下：")])]),t._v(" "),e("div",{staticClass:"language-yml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.7"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pea3nut/pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8082:80"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" on"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("failure\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+   blog")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+       container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pea3nut"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("blog\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+       image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tutum/lamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+       ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n+           "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8081:80"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+       volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n+           "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./blog/mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/lib/mysql\n+           "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./blog/wordpress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/app\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("+       restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" on"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("failure\n")])])]),e("h4",{attrs:{id:"参考文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://juejin.cn/post/6932808129189150734",target:"_blank",rel:"noopener noreferrer"}},[t._v("利用docker搭建前端开发环境"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://juejin.cn/post/6844903946234904583",target:"_blank",rel:"noopener noreferrer"}},[t._v("写给前端的Docker实战教程"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);