<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack入门到精通 | Alan的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="细数现今最流行的打包工具，非webpack莫属~

对比 webpack gulp grunt
webpack v1.x  2014.02
webpack v2.x  2017.01
webpack v3.x  2017.06
webpack v4.x  4.32.2   // 2018 02 正式版
webpack v5.x  v5.50.0   // 2 ...">
    
    <link rel="preload" href="/blog/assets/css/0.styles.ae7fb01b.css" as="style"><link rel="preload" href="/blog/assets/js/app.d377f9a8.js" as="script"><link rel="preload" href="/blog/assets/js/13.cdda75ce.js" as="script"><link rel="preload" href="/blog/assets/js/3.6e92e369.js" as="script"><link rel="preload" href="/blog/assets/js/10.d7440df3.js" as="script"><link rel="prefetch" href="/blog/assets/js/11.0f75d598.js"><link rel="prefetch" href="/blog/assets/js/12.e3dad924.js"><link rel="prefetch" href="/blog/assets/js/14.5505cb55.js"><link rel="prefetch" href="/blog/assets/js/15.53f28293.js"><link rel="prefetch" href="/blog/assets/js/16.e2112a01.js"><link rel="prefetch" href="/blog/assets/js/17.3382d02b.js"><link rel="prefetch" href="/blog/assets/js/18.652af8b8.js"><link rel="prefetch" href="/blog/assets/js/19.d92bcd2d.js"><link rel="prefetch" href="/blog/assets/js/20.0ca3e92e.js"><link rel="prefetch" href="/blog/assets/js/21.cf261eb8.js"><link rel="prefetch" href="/blog/assets/js/22.0274147f.js"><link rel="prefetch" href="/blog/assets/js/23.24c6d75c.js"><link rel="prefetch" href="/blog/assets/js/24.0c5253e1.js"><link rel="prefetch" href="/blog/assets/js/25.94c44222.js"><link rel="prefetch" href="/blog/assets/js/26.d02cc279.js"><link rel="prefetch" href="/blog/assets/js/27.e530fb61.js"><link rel="prefetch" href="/blog/assets/js/28.c7c2df58.js"><link rel="prefetch" href="/blog/assets/js/29.b900fe7b.js"><link rel="prefetch" href="/blog/assets/js/30.c0d9bf50.js"><link rel="prefetch" href="/blog/assets/js/31.4640e6c2.js"><link rel="prefetch" href="/blog/assets/js/32.65c578d1.js"><link rel="prefetch" href="/blog/assets/js/33.238f8484.js"><link rel="prefetch" href="/blog/assets/js/34.47fe14a6.js"><link rel="prefetch" href="/blog/assets/js/35.dd97b64b.js"><link rel="prefetch" href="/blog/assets/js/36.bbf2dc14.js"><link rel="prefetch" href="/blog/assets/js/37.cc9f13e1.js"><link rel="prefetch" href="/blog/assets/js/38.b4c2f687.js"><link rel="prefetch" href="/blog/assets/js/39.7fa52631.js"><link rel="prefetch" href="/blog/assets/js/4.3793fc68.js"><link rel="prefetch" href="/blog/assets/js/40.7124080e.js"><link rel="prefetch" href="/blog/assets/js/41.0dd5ac08.js"><link rel="prefetch" href="/blog/assets/js/42.e6135314.js"><link rel="prefetch" href="/blog/assets/js/43.3032bda2.js"><link rel="prefetch" href="/blog/assets/js/44.f7ffa396.js"><link rel="prefetch" href="/blog/assets/js/45.476f9d2c.js"><link rel="prefetch" href="/blog/assets/js/46.5b298dbb.js"><link rel="prefetch" href="/blog/assets/js/47.1db03b10.js"><link rel="prefetch" href="/blog/assets/js/48.b0f94012.js"><link rel="prefetch" href="/blog/assets/js/49.7a11fe37.js"><link rel="prefetch" href="/blog/assets/js/5.98ad11c8.js"><link rel="prefetch" href="/blog/assets/js/50.fdff941c.js"><link rel="prefetch" href="/blog/assets/js/51.9a40e885.js"><link rel="prefetch" href="/blog/assets/js/52.fa31a84c.js"><link rel="prefetch" href="/blog/assets/js/53.bd199e39.js"><link rel="prefetch" href="/blog/assets/js/54.54fc39f6.js"><link rel="prefetch" href="/blog/assets/js/6.b2fc444d.js"><link rel="prefetch" href="/blog/assets/js/7.b470cadf.js"><link rel="prefetch" href="/blog/assets/js/8.715a2d16.js"><link rel="prefetch" href="/blog/assets/js/9.50f121db.js"><link rel="prefetch" href="/blog/assets/js/vuejs-paginate.befbb007.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ae7fb01b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">Alan的博客 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/" class="nav-link">博客</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">标签</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">Alan的博客 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/" class="nav-link">博客</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">标签</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        webpack入门到精通
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Alan</span> <span itemprop="address">   in Shanghai</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2022-03-12T00:00:00.000Z">
      Sat Mar 12 2022
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/webpack" data-v-42ccfcd5><span data-v-42ccfcd5>webpack</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/build" data-v-42ccfcd5><span data-v-42ccfcd5>build</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>细数现今最流行的打包工具，非webpack莫属~</p> <h3 id="对比-webpack-gulp-grunt"><a href="#对比-webpack-gulp-grunt" class="header-anchor">#</a> 对比 webpack gulp grunt</h3> <p>webpack v1.x  2014.02
webpack v2.x  2017.01
webpack v3.x  2017.06
webpack v4.x  4.32.2   // 2018 02 正式版
webpack v5.x  v5.50.0   // 2020 10 正式版</p> <h3 id="模块化"><a href="#模块化" class="header-anchor">#</a> 模块化</h3> <h4 id="先介绍下jquery的写法"><a href="#先介绍下jquery的写法" class="header-anchor">#</a> 先介绍下jQuery的写法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>jQuery<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  root<span class="token punctuation">.</span>jQuery<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
</code></pre></div><ul><li>命名空间</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>dev <span class="token operator">=</span> obj<span class="token punctuation">.</span>dev <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>dev<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>dev<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>dev<span class="token punctuation">.</span><span class="token function-variable function">sub</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

 obj<span class="token punctuation">.</span>sale <span class="token operator">=</span> obj<span class="token punctuation">.</span>sale <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>sale<span class="token punctuation">.</span><span class="token function-variable function">remove</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 obj<span class="token punctuation">.</span>sale<span class="token punctuation">.</span><span class="token function-variable function">append</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="amd和cmd"><a href="#amd和cmd" class="header-anchor">#</a> AMD和CMD</h4> <ul><li><p>amd
全称：Asynchronous Module Definition
<a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="noopener noreferrer">AMD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是 RequireJS 在推广过程中对模块定义的规范化产出</p></li> <li><p>cmd
全称： Common Module Definition
<a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="noopener noreferrer">CMD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是 SeaJS 在推广过程中对模块定义的规范化产出</p></li></ul> <h5 id="amd和cmd的区别"><a href="#amd和cmd的区别" class="header-anchor">#</a> amd和cmd的区别：</h5> <ol><li>对于依赖的模块，AMD 是提前执行，CMD 是延迟执行。不过 RequireJS 从 2.0 开始，
也改成可以延迟执行（根据写法不同，处理方式不同）。CMD 推崇 as lazy as possible.</li> <li>CMD 推崇依赖就近，AMD 推崇依赖前置</li></ol> <p>代码示例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CMD  seajs</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
   <span class="token comment">// 此处略去 100 行   </span>
   <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖可以就近书写   </span>
   b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// </span>
  <span class="token operator">...</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// AMD requirejs 默认推荐的是</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./a'</span><span class="token punctuation">,</span> <span class="token string">'./b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token comment">// 依赖必须一开始就写好    </span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token comment">// 此处略去 100 行    </span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="commonjs和es6-module-es6模块化"><a href="#commonjs和es6-module-es6模块化" class="header-anchor">#</a> commonJS和es6 Module(es6模块化)</h4> <ul><li>commonjs<br>
应用场景： nodejs</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token comment">// 导出</span>
require  <span class="token comment">//导入</span>
</code></pre></div><ul><li>es6 Module
应用场景： nodejs</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">export</span> <span class="token operator">|</span> <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token comment">// 导出</span>
 <span class="token keyword">import</span> <span class="token operator">...</span> <span class="token keyword">from</span> <span class="token string">'xxx'</span>   <span class="token comment">// 导入</span>
</code></pre></div><h4 id="cmd-amd-commonjs-es6-module有什么区别"><a href="#cmd-amd-commonjs-es6-module有什么区别" class="header-anchor">#</a> <a href="https://juejin.cn/post/6844903983987834888" target="_blank" rel="noopener noreferrer">cmd, amd, commonjs, es6 module有什么区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>AMD一开始是CommonJS规范中的一个草案, 由requirejs实现，所以amd一般指requirejs
commonjs属于服务端模块化机制，nodejs，webpack都是基于该规范来实现。
es6 Module是es6中规定的模块体系，有望成为浏览器和服务器通用的模块解决方案</p> <h4 id="es6-module对比commonjs区别"><a href="#es6-module对比commonjs区别" class="header-anchor">#</a> es6 module对比commonjs区别</h4> <ol><li>CommonJS模块是运行时加载，ES6 Module是编译时输出接口；</li> <li>CommonJS加载的是整个模块，将所有的接口全部加载进来，ES6 Module可以单独加载其中的某个接口；</li> <li>CommonJS输出是值的拷贝，ES6 Module输出的是值的引用，被输出模块的内部的改变会影响引用的改变；</li> <li>CommonJS this指向当前模块，ES6 Module this指向undefined;</li></ol> <p>前面说的是js的模块化，下面说说css模块化</p> <h4 id="css模块化"><a href="#css模块化" class="header-anchor">#</a> css模块化</h4> <p>OOCSS（面向对象CSS） // 适用于大项目</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">------------index.css-----------
  w100</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">h100</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100px
  <span class="token punctuation">}</span>

------------index.html----------------
&lt;div class=<span class="token string">&quot;w100 h100&quot;</span>&gt;&lt;/div&gt;

</code></pre></div><h4 id="vue-scoped-style-scoped实现原理"><a href="#vue-scoped-style-scoped实现原理" class="header-anchor">#</a> vue scoped/style scoped实现原理</h4> <p>AMCSS(属性模块) 属性选择器，避免使用过多的class</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">---------------index.css--------------
  [auto-test=&quot;abc&quot;]</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
-----------------index.vue---------------
  &lt;div auto-test=<span class="token string">&quot;abc&quot;</span>&gt;&lt;/div&gt;
</code></pre></div><h2 id="webpack-4-x"><a href="#webpack-4-x" class="header-anchor">#</a> webpack 4.x</h2> <h3 id="webpack-常用命令"><a href="#webpack-常用命令" class="header-anchor">#</a> webpack 常用命令</h3> <div class="language- extra-class"><pre class="language-text"><code>  npm uninstall webpack -g  // 卸载全局webpack
  npm install webpack -g    // 安装全局webpack
  webpack --version  // 查看webpack版本
  npm info webpack // webpack版本list
</code></pre></div><h3 id="webpack初始化项目"><a href="#webpack初始化项目" class="header-anchor">#</a> webpack初始化项目</h3> <div class="language-js extra-class"><pre class="language-js"><code>  npm init <span class="token operator">-</span>y
</code></pre></div><h3 id="webpack多入口打包"><a href="#webpack多入口打包" class="header-anchor">#</a> webpack多入口打包</h3> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/multi-entry" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code>webpack app<span class="token punctuation">.</span>js main<span class="token punctuation">.</span>js <span class="token operator">-</span>o bundle<span class="token punctuation">.</span>js <span class="token operator">--</span>mode <span class="token string">&quot;development&quot;</span>
</code></pre></div><h3 id="webpack基本配置"><a href="#webpack基本配置" class="header-anchor">#</a> webpack基本配置</h3> <div class="language-js extra-class"><pre class="language-js"><code>  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/app.js&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 入口</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 模式</span>
    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;source-map&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token comment">// dev服务</span>
      <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token string">&quot;8000&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 输出路径</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name]-[hash:5].js&quot;</span> <span class="token comment">// 文件名</span>
      <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&quot;[name]&quot;</span>  <span class="token comment">// 通过全局变量暴露出去</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 别名</span>
        <span class="token string-property property">&quot;@/&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">extension</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.css&quot;</span><span class="token punctuation">]</span>  <span class="token comment">// 文件名扩展</span>
    <span class="token punctuation">}</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 加载loader list</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 插件</span>
      <span class="token keyword">new</span> <span class="token class-name">Htmlwebpackplugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token comment">// 打包优化</span>
      <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>   
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="es6-转es5语法"><a href="#es6-转es5语法" class="header-anchor">#</a> ES6+转es5语法</h3> <h4 id="_1-全局垫片"><a href="#_1-全局垫片" class="header-anchor">#</a> (1) 全局垫片</h4> <ul><li><p>下载babel<br> <code>npm i babel-loader @babel/core @babel/preset-env --save-dev</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/es6Toes5" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
webpack打包后只能将我们es6+的语法转成ES5的语法，但是ES6的一些内置API和功能（Promise Set Map）Object.assign() 如果我们要实现这些这些，我们需要使用 垫片库（polyfill）</p></li> <li><p>后台系统可以考虑不用babel-loader
<img src="/blog/assets/img/115.1f4b9c02.png" width="600px"></p></li></ul> <p><code>npm install -D @babel/polyfill</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">import</span> <span class="token string">&quot;@babel/polyfill&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 全局垫片</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// IE不支持Promise</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
result<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
   <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 默认es6语法转es5, 部分api(promise)需要配置babelrc</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="ie运行情况如下-未加垫片"><a href="#ie运行情况如下-未加垫片" class="header-anchor">#</a> IE运行情况如下(未加垫片)</h5> <img src="data:image/png;base64,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"> <img src="data:image/png;base64,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"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>babelrc<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">//全局垫片配置如下  ps: 全局垫片是在修改原型，所以不安全。</span>
<span class="token punctuation">{</span>
	<span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
		<span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span><span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 不需要入口文件import @babel/polyfill</span>
		<span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  <span class="token comment">// 兼容目标</span>
			 <span class="token comment">// chrome:&quot;67&quot;</span>
			 <span class="token string-property property">&quot;ie&quot;</span><span class="token operator">:</span><span class="token string">&quot;9&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>ps: 开发库或者框架的话请使用局部垫片</code></p> <h4 id="_2-局部垫片"><a href="#_2-局部垫片" class="header-anchor">#</a> (2) 局部垫片</h4> <ul><li>安装
<code>npm install --save-dev @babel/plugin-transform-runtime @babel/runtime</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/es6Toes5" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>babelrc<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// 局部垫片</span>
<span class="token punctuation">{</span>
	<span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;absoluteRuntime&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;helpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;regenerator&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;useESModules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span> 
<span class="token punctuation">}</span>
报错： <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Module not found: Error: Can't resolve '@babel/runtime-corejs2/core-js/promise' in 'c:\Users\Gao\Desktop\code'</span><span class="token template-punctuation string">`</span></span>

需要下载一个包：<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">npm install --save @babel/runtime-corejs2</span><span class="token template-punctuation string">`</span></span>
</code></pre></div><h4 id="全局垫片和局部垫片的区别"><a href="#全局垫片和局部垫片的区别" class="header-anchor">#</a> 全局垫片和局部垫片的区别</h4> <img src="/blog/assets/img/118.5aceab6c.png" width="600px"> <h3 id="支持ts"><a href="#支持ts" class="header-anchor">#</a> 支持ts</h3> <p><code>npm install --save-dev typescript ts-loader</code> <code>npm install @types/lodash</code> // 安装类型约束
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/typescript" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>demo<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> String
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">person</span><span class="token operator">:</span> Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">getPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;alan&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">&quot;20&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// ts-loader配置，也可以配置tsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.tsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">&quot;ts-loader&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">transpileOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">compilerOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token string">&quot;es6&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;es5&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">jsx</span><span class="token operator">:</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">allowJs</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;./src/&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;./&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;node_modules&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>tsconfig<span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">transpileOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">compilerOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token string">&quot;es6&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;es5&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">jsx</span><span class="token operator">:</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowJs</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;./src/&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;./&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;node_modules&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="ts类型约束"><a href="#ts类型约束" class="header-anchor">#</a> ts类型约束</h4> <p><code>http://microsoft.github.io/TypeSearch/</code></p> <h4 id="打包图片"><a href="#打包图片" class="header-anchor">#</a> 打包图片</h4> <p><code>npm install file-loader --save-dev</code> <code>npm install url-loader --save-dev</code>  // url-loader内置了file-loader,可以把图片写成base64格式
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/images" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
	<span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="打包css"><a href="#打包css" class="header-anchor">#</a> 打包css</h4> <p><code>npm install --save-dev css-loader style-loader</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/css" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span>  <span class="token comment">// loader加载从右到左</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="打包css预编译处理语言-scss-less-stylus"><a href="#打包css预编译处理语言-scss-less-stylus" class="header-anchor">#</a> 打包css预编译处理语言(scss, less, stylus)</h4> <p><code>npm install sass-loader node-sass --save-dev</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/sass" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="添加css3前缀"><a href="#添加css3前缀" class="header-anchor">#</a> 添加css3前缀</h4> <p><code>npm install -D postcss-loader autoprefixer</code> <a href="https://github.com/alan89757/autoprefixer" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// ps：注意包版本</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;clean-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0-alpha.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;html-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.3.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;autoprefixer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;css-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;postcss-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;style-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.2.1&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4.43.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3.3.11&quot;</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loade&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;postcss-loader&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="css模块化打包"><a href="#css模块化打包" class="header-anchor">#</a> css模块化打包</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Apple <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./fruits.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">&quot;./app.scss&quot;</span>
<span class="token keyword">import</span> apple <span class="token keyword">from</span> <span class="token string">&quot;./apple.png&quot;</span>

<span class="token function">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 画一个苹果</span>

<span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> apple<span class="token punctuation">;</span>
<span class="token comment">// img.classList.add(&quot;apple&quot;);  // 普通写法</span>
img<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>styles<span class="token punctuation">.</span>apple<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// css模块化写法</span>
<span class="token keyword">var</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>  fruits<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> apple <span class="token keyword">from</span> <span class="token string">&quot;./apple.png&quot;</span>
<span class="token keyword">function</span> <span class="token function">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  img<span class="token punctuation">.</span>src <span class="token operator">=</span> apple<span class="token punctuation">;</span>
  img<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  dom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  Apple
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span>  <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token comment">// css模块化</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/cssModule" target="_blank" rel="noopener noreferrer">demo源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="配置支持font"><a href="#配置支持font" class="header-anchor">#</a> 配置支持font</h4> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/font" target="_blank" rel="noopener noreferrer">demo源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span>  <span class="token string">&quot;css-loader&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|svg|eot|ttf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;file-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">outputPath</span><span class="token operator">:</span> <span class="token string">&quot;font/&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;[name]-[contentHash:5].[ext]&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="plugins使用-常用"><a href="#plugins使用-常用" class="header-anchor">#</a> Plugins使用（常用）</h4> <p><code>npm install -D html-webpack-plugin</code>  // 模板配置
<code>npm install -D clean-webpack-plugin</code>  // 清除dist/数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="模板中注入静态文件"><a href="#模板中注入静态文件" class="header-anchor">#</a> 模板中注入静态文件</h4> <p><code>npm i add-asset-html-webpack-plugin</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/envVar" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">AddAssetHtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">filepath</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./dll/vendors.dll.js&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="静态资源同步到cdn"><a href="#静态资源同步到cdn" class="header-anchor">#</a> 静态资源同步到CDN</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;https://aidianzan.com/&quot;</span>   <span class="token comment">// index.html会引入https://static.cdn.com/下的资源</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如下图：
<img src="/blog/assets/img/119.ae080c8e.png" width="600px"></p> <h4 id="sourcemap-的配置-快速定位到源码所在位置"><a href="#sourcemap-的配置-快速定位到源码所在位置" class="header-anchor">#</a> sourceMap 的配置（快速定位到源码所在位置）</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;cheap-module-source-map&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="开启本地服务webpackdevserver"><a href="#开启本地服务webpackdevserver" class="header-anchor">#</a> 开启本地服务webpackDevServer</h4> <ol><li><code>webpack --watch</code>  // 需要手动刷新浏览器</li> <li><code>webpack-dev-server</code>  // 自动刷新</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config ./build/webpack.config.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">contentBase</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">9091</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 开启热模块更新,同时配置插件webpack.HotModuleReplacementPlugin</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>   <span class="token comment">// 反向代理</span>
      <span class="token string-property property">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:9090&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">pathRewrite</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;^/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// hot: true</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="hmr-热模块更新"><a href="#hmr-热模块更新" class="header-anchor">#</a> HMR(热模块更新)</h3> <p><a href="%5Bdemo%5D(https://github.com/alan89757/webpack-analysis/tree/master/src/hmr)">demo</a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> <span class="token string">&quot;./app.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;新增按钮&quot;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span>

btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	div<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">&quot;hahaha&quot;</span><span class="token punctuation">;</span>
	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>css<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token literal-property property">div</span><span class="token operator">:</span>nth<span class="token operator">-</span><span class="token keyword">of</span><span class="token operator">-</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token parameter">odd</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token literal-property property">background</span><span class="token operator">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="treeshaking"><a href="#treeshaking" class="header-anchor">#</a> treeShaking</h4> <p>只有es module支持treeShaking(因为只有esModule支持单独加载模块的某个接口), 只有生产模式能做treeShaking(开发模式不支持)，配置mode=production就可以了
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/treeshaking" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;slideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>  <span class="token comment">// 过滤不需要treeshaking的文件</span>
    <span class="token string">&quot;@babel/polyfill&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;*.css&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="development-和-production"><a href="#development-和-production" class="header-anchor">#</a> development 和 production</h4> <p>提取一个公共的配置文件webpack.common.js</p> <p><code>npm i webpack-merge</code>  // 类似Object.assign
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/envVar" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.common.js&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">9090</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span>     <span class="token comment">// 开启热模块更新</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.common&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&quot;./src/envVar/main.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span> 
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="两种引入第三方库的方式"><a href="#两种引入第三方库的方式" class="header-anchor">#</a> 两种引入第三方库的方式</h4> <h5 id="通过expose-loader-进行全局变量注入"><a href="#通过expose-loader-进行全局变量注入" class="header-anchor">#</a> 通过expose-loader 进行全局变量注入</h5> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/expose-loader" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>npm i -D expose-loader@0.7.5</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token comment">// 这里是require，不是path</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 获取jquery绝对路径，loader只会作用与jquery</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;expose-loader&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token string">&quot;$&quot;</span>    <span class="token comment">// 挂载到全局变量了</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;backgroundColor&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;yellowgreen&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>$<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><img src="/blog/assets/img/120.c10abfc3.png" width="600px"> <h5 id="通过内置插件-webpack-provideplugin对每个模块的的空间注入一个变量-然后去自动加载模块-就不用在每个文件内去引入import-或者require"><a href="#通过内置插件-webpack-provideplugin对每个模块的的空间注入一个变量-然后去自动加载模块-就不用在每个文件内去引入import-或者require" class="header-anchor">#</a> 通过内置插件，webpack.ProvidePlugin对每个模块的的空间注入一个变量，然后去自动加载模块，就不用在每个文件内去引入import 或者require</h5> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/provide-plugin" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 每个模块空间注入一个jquery</span>
  <span class="token literal-property property">$</span><span class="token operator">:</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">jQuery</span><span class="token operator">:</span> <span class="token string">&quot;jquery&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// import $ from &quot;jquery&quot;; // 不需要手动引入</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;backgroundColor&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;yellowgreen&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h5 id="externals"><a href="#externals" class="header-anchor">#</a> externals</h5> <p>在html文件中引入cdn文件，在webpack配置externals，这样就不会打包引入的cdn的库
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/externals" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>index<span class="token punctuation">.</span>html<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>externals<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script
  src<span class="token operator">=</span><span class="token string">&quot;https://code.jquery.com/jquery-3.1.0.js&quot;</span>
  integrity<span class="token operator">=</span><span class="token string">&quot;sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=&quot;</span>
  crossorigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;root&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token string">'jQuery'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>效果如下图：
<img src="/blog/assets/img/121.a1c8f938.png" width="600px"> <img src="/blog/assets/img/122.805b9c47.png" width="600px"></p> <h4 id="反向代理"><a href="#反向代理" class="header-anchor">#</a> 反向代理</h4> <p>跨域的解决方式：</p> <ul><li>jsonp // 只支持get，比较少用</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>-----------------index.html--------------
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>JSONP 实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>divCustomers<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">callbackFn</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> methodName</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;ul&gt;'</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        html <span class="token operator">+=</span> <span class="token string">'&lt;li&gt;'</span> <span class="token operator">+</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&lt;/li&gt;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    html <span class="token operator">+=</span> <span class="token string">'&lt;/ul&gt;'</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'divCustomers'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:3000?jsoncallback=callbackFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>server<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token string">'[&quot;苹果&quot;,&quot;香蕉&quot;,&quot;凤梨&quot;,&quot;火龙果&quot;]'</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;callbackFn('&quot;</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">&quot;')&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;服务启动中...&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>cors   // 服务器配置</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>-----------------index.html-----------------
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>cors<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:3000/getJSON&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>hello<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>server<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getJSON'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">&quot;world&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;服务启动中...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>proxy代理  // webpack支持配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>   <span class="token comment">// 反向代理</span>
    <span class="token string-property property">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:9090&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">pathRewrite</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;^/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="代码分割-代码分割和webpack无关-用来提升性能"><a href="#代码分割-代码分割和webpack无关-用来提升性能" class="header-anchor">#</a> 代码分割（代码分割和webpack无关，用来提升性能）</h2> <ul><li>入口起点(多入口)：使用entry配置手动的分离代码
将不同的文件内引入的相同的库会分别打包到不同的文件中(使用很少)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&quot;./src/entry/main.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">app</span><span class="token operator">:</span> <span class="token string">&quot;./src/entry/app.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>防止重复：使用SplitChunksPlugin去重和分离chunk, webpack4.x以前用CommonChunkPlugin</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// splitChunks详细配置</span>
<span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token comment">// 3个值async initial， all,针对异步，同步，所有代码做分割</span>
      <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 引入的包或者模块大于30000个字节才会做代码分割,针对于同步加载的模块才有效</span>
      <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 可配置，也不可配置，当打包的内容超出这个值之后，会尝试二次打包，但是拆分不了的部分，就无法拆分，不太常用</span>
      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 引入次数，引入次数为 n 可以打包</span>
      <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 异步加载时同时发送的请求数量不能超过5个，超过5个的部分不才分，一般不去修改</span>
      <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token comment">// 页面初始化时同时发送的请求数量最大不能超过3个，超过的3个部分就不ibei拆分</span>
      <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span> <span class="token comment">//打包出来的文件名的默认连接符</span>
      <span class="token comment">// automaticNameMaxLength: 30, // 文件名最长不能超过30个字符</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 拆分的chunk名，true 表示根据模块名和CacheGroup组的key来自动生成，使用上面的连接符</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 缓存配置：一个文件内import 多个库，如果需要将多个库打包在一个文件内就要缓存,所以命名为缓存组</span>
        <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 监测引入的库是否是node_modules下的，jquery，lodash，</span>
          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token comment">//权重：决定哪个组优先匹配，比如：node_modules下面有模块要拆分，如果同时后满足vendors ，default组，哪个priority值大，就按照哪个组去打包</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// </span>
          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
					<span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 当main.js引入 a.js,b.js, 但是a 中引入了b，就会重复引用，开始这个属性之后，就不会重复打包b.js,会复用</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>动态导入：通过模块的懒加载调用来分离代码
webpack4 默认允许import语法动态导入，它是ES7的提交草案，需要babel的插件支持，最新版的babel插件包<code>@babel/plugin-syntax-dynamic-import</code> <strong>注意：动态导入的最大好处是实现了懒加载</strong>，用到某个模块就加载哪个模块，SPA vue react路由懒加载 原理一样</li></ul> <p><code>npm i -D @babel/plugin-syntax-dynamic-import</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 执行的时候才会引入jquery</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> $<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName:&quot;jquery&quot; */</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;div&gt;&lt;/div&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	<span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>babelrc<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;browsers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;last 2 chrome versions&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="懒加载和动态导入有什么区别"><a href="#懒加载和动态导入有什么区别" class="header-anchor">#</a> 懒加载和动态导入有什么区别</h4> <p>动态导入的最大好处是实现了懒加载</p> <h4 id="打包分析"><a href="#打包分析" class="header-anchor">#</a> 打包分析</h4> <ol><li>脚本加入 --profile --json &gt; stats.json  // 注意webpack和webpack-cli版本
把生成stats.json放入https://webpack.github.io/analyse/</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;analyse-file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --profile --json &gt; stats.json --config ./src/analyse-file/webpack.config.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.43.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.2&quot;</span><span class="token punctuation">,</span>    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><img src="/blog/assets/img/123.d51e8718.png" style="width:600px;"> <ol start="2"><li>插件分析
<code>npm install --save-dev webpack-bundle-analyzer</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">app</span><span class="token operator">:</span> <span class="token string">&quot;./src/bundle-analyzer/app.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">contentBase</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">9090</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span>     <span class="token comment">// 开启热模块更新</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 代码分析</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/bundle-analyzer" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="prefetch和preload"><a href="#prefetch和preload" class="header-anchor">#</a> prefetch和preload</h4> <h5 id="prefetch-预加载"><a href="#prefetch-预加载" class="header-anchor">#</a> prefetch 预加载</h5> <p>在网络空闲的时候，一般是首页核心代码加载完成之后，再偷偷加载其他js代码,即预加载。
资源的下载顺序权重比较低。也就是说prefetch通常用于加速下一次导航，而不是本次的。被标记为prefetch的资源，将会被浏览器在空闲时间加载。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 预加载</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">&quot;./app.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> add<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">function</span> <span class="token function">addDiv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> addDiv<span class="token punctuation">;</span>
</code></pre></div><h5 id="preload-优先加载-较高优先级"><a href="#preload-优先加载-较高优先级" class="header-anchor">#</a> preload 优先加载（较高优先级）</h5> <p>通常用于本页面要用到的关键资源，包括关键js、字体、css文件。preload将会把资源得下载顺序权重提高，使得关键数据提前下载好，优化页面打开速度。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">function</span> <span class="token function">addDiv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> addDiv<span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span> <span class="token string">&quot;./main.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> add<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>缓存带来的代码提升是有限的，所以懒加载代码优化成为我们性能提升的最重要的方式</code></p> <h4 id="css文件代码分割"><a href="#css文件代码分割" class="header-anchor">#</a> css文件代码分割</h4> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/css-split" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>安装插件
<code>npm i -D mini-css-extract-plugin</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>  <span class="token comment">// 替换掉&quot;style-loader&quot;</span>
          <span class="token string">&quot;css-loader&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="css压缩"><a href="#css压缩" class="header-anchor">#</a> css压缩</h4> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/css-compress" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>安装插件
<code>npm i -D optimize-css-assets-webpack-plugin@5.0.1</code></p></li> <li><p>配置webpack</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;optimize-css-assets-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserJSPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 压缩css会使js压缩无效时使用该插件</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserJSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].[contenthash:5].js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&quot;[name]-[contenthash:5].js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="webpack浏览器文件存储"><a href="#webpack浏览器文件存储" class="header-anchor">#</a> webpack浏览器文件存储</h4> <p>第三方库单独打包vendor，可以使用缓存</p> <h4 id="通过环境变量走不同的配置"><a href="#通过环境变量走不同的配置" class="header-anchor">#</a> 通过环境变量走不同的配置</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">scripts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">dev</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config ./build/webpack.common.js&quot;</span>
    <span class="token literal-property property">prod</span><span class="token operator">:</span> <span class="token string">&quot;webpack --env.production --config ./build/webpack.common.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.prod.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.dev.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>env <span class="token operator">&amp;&amp;</span> env<span class="token punctuation">.</span>production<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="编译vue"><a href="#编译vue" class="header-anchor">#</a> 编译vue</h4> <ol><li>安装模块
<code>npm i -S vue</code> <code>npm i -D vue-loader vue-template-compiler</code>
vue-loader只要是15.x版本都需要配置一个插件
<a href="https://github.com/alan89757/webpack-analysis/tree/master/src/vue-cli" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

<span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader/lib/plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">AddAssetHtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">filepath</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./dll/vendors.dll.js&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="编译react"><a href="#编译react" class="header-anchor">#</a> 编译react</h4> <p><code>npm i @babel/preset-env @babel/preset-react -D</code> <a href="https://github.com/alan89757/webpack-analysis/tree/master/src/react-cli" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>webpack react<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>babelrc<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@babel/preset-react&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="webpack打包速度优化"><a href="#webpack打包速度优化" class="header-anchor">#</a> webpack打包速度优化</h4> <ol><li>更新node或者webpack版本</li> <li>减少loader转换</li> <li>少使用非官方提供的插件</li> <li>使用DllPlugin提高打包速度</li></ol> <h4 id="配置多个dll文件"><a href="#配置多个dll文件" class="header-anchor">#</a> 配置多个dll文件</h4> <p>减少单个dll大小</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">&quot;./index.html&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">$</span><span class="token operator">:</span><span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">jQuery</span><span class="token operator">:</span><span class="token string">&quot;jquery&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// console.log(files)</span>
files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fileName</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*\.dll\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		  plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
				<span class="token keyword">new</span> <span class="token class-name">AddAssetHtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 第三方模块文件</span>
					<span class="token literal-property property">filepath</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&quot;../dll&quot;</span><span class="token punctuation">,</span>fileName<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">)</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*\.mainfest\.json</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		  plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
				<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 映射文件</span>
					<span class="token literal-property property">manifest</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dll&quot;</span><span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">)</span>
	 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="多线程打包"><a href="#多线程打包" class="header-anchor">#</a> 多线程打包</h4> <p><code>npm i thread-loader -D</code>  // 多线程耗费性能，慎重</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
   <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;thread-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">workers</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 默认es6语法转es5, 部分api(promise)需要配置babelrc</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="图片压缩"><a href="#图片压缩" class="header-anchor">#</a> 图片压缩</h4> <ul><li>有损压缩
<code>npm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo --save-dev</code></li> <li>无损压缩
<code>npm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo --save-de</code></li></ul> <h4 id="npm打包发布自己写的插件"><a href="#npm打包发布自己写的插件" class="header-anchor">#</a> npm打包发布自己写的插件</h4> <ol><li>npm login
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeUAAABdCAYAAACb3n7OAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABHDSURBVHhe7Z0xluS2DkX/SmYjXoOX4AU4d+rUoUNnE03kbCInjiaZyHuaf27/875hGIAotapb6n7BPRIJEAQpiq9UXVX9nw8fPnwzxhhjzOtjUTbGGGMugkXZGGOMuQibovz9999/++OPP56Olf21+e2337799ddfT/z++++lzxEY75cvX57G/t1335U+xhhjzJm0oixRkuDBzz//XPpeAcTZomyMMebOlKIsQULoEOIzxe5RnC3KxhhjzEtTivKPP/74JMocEWUEr/LL8ET5+fPnpzZ6yuaIyE826rDxVPr169dvv/7669Nxz1NqJcr5aT/GyzagT8ZMLNXFmNMY5GOMMcYcpRRlxEcCiQjtEWW1Q9xUpn224Y/gASKHwHGkjNDh8+eff/7fd4ssyrHvWJaP+uacPsiL/tUeupjV+GI7Y4wx5gjjB70QGz0xrgiPRCqKm4StsnGuOo744Esbnj6fI8rEzE+xEno9JSuXTlxzzGl8KhtjjDFHGUUZEeJJWW8nb4nPJFqVTcLJ8RGirJiqkygrF/lTr6dz+YJF2RhjzEsyijLCiAhxRHyyyGUm0apsEs4ooPjS5gxRzk/KsQ5fvQvQvROQY1qUjTHGPJJRlBFEnpQlzlvis0eUiYlAYqfubFGO8Smrf8rE1NvY8q/IMS3KxhhjHkkpyohOfIqEFeFZEeUYU4J5VJSrmKBcJcy5HjiPbYB+p5jT+FQ2xhhjjjI+KSM+ZwlOJWivRfWkTB0CvvpkbowxxpzNKMo8Bepp9rlcSZTJQX9bVh3jzHXGGGPMSzKK8plcSZQhv31tQTbGGPPavJgoG2OMMWbGomyMMcZcBIuyMcYYcxEsysYYY8xFsCifjL4bzYfa+HBb5QN80Cx+sn21nTHGmLdLKcrVV4aqOvNvLMrGGGOOYlF+JbIoG2OMMYdEWd85rr7jm23xF8EkRCA7cWnDb2yrj62YeprEn3aU+S9W+m9Wsk+5APHpJ9dPdLlgi+PKMXM7kCjvaaf+oJuzqi/A92jMmJMxxpjHcEiUEZFOyKiXTZu/xId6NnrZqZcgcERQ+ZnL3A6x1c9fRhs5SWyISX76CU2OUy5wRJS7XKIP5Rwz5qLySruuP513cxbR/Kh8RkxjjDHnc1iUsx0os4nndtSxwSMMOsfGxo+AavPHV+3oIwtUtuXY1NO3ftd6yiXGew5VnrlO44y5KF+VoYqVkc/qnFXzkNkb0xhjzGM4/DdlNmq9/cnGTR3iw1OW6oWEkDbyjWyJQRUXG/45NvnpSXnKRf3spcsl+mQhe44od/2tCijl6APPjWmMMeYxlKJciUgUwOiLD2LN5l21i7C5ZyGCSQxi/GyLOSk2/hLlKZcjTLlEv1xX5aJ8VYbcbupvRUCxxTI8N6YxxpjHUYqyNm5tztqs40Yuok3n3SZO/RSjEoOci57ysFFHO9orNv4I4FYuoNiTT2TKJfopd5VzO+w8nea52GoX+5vmTL7Vi5LnxDTGGPNYSlEGbdbx7U3qtXGrPto6u8QHvyxEsU0nBpwrFoLy6dOnJxv+tKO9YiM6elKecgEJVMx/iy6Xqi9QbHKNdcSBrXZb/VVz9oiYKhtjjHkcrSgbY4wx5mWxKBtjjDEXwaJsjDHGXASLsjHGGHMRLMrGGGPMRbAoG2OMMRfBomyMMcZchHclynzflu/dVjZjjDHmtSlFWT+qUf3wxJ2xKBtjjLkyoyjrl530S093F2aLsjHGmCuzJMrAOXXY8s84ck4dftmmNpOtEkv50q/yUbvYn9qC7PnFhOoh9qO4d3+xYYwx5m1wSJSnf/TPsRO5zlbVK26Or7L8OSK2KuOndtTFuJwrDliUjTHGXIklUVY5ClokiirnEu/Kr7LRj9pLOPHhH0vEFwPyj/8BCX+JcLRFH7VTbJWNMcaYK7H8Qa8oZghe/A9SIFEFzqt2nY14nz9//vbDDz882T9+/PiUA2KLKEfRlX8U5UpoLcrGGGPuxvLb19kWxY1zBC/6QeVb2ThHeHlbnDKiTN8IdfWkHOssysYYY94Kh0VZNj01V6Kc/x7c2YjJOWJMPOqIB+pPMXLMTmhznvjkJ3f5VLkbY4wxL81uUQYJHOA3/aN/Cd6KDTiX0EtAlU9uB5xXogzkH9vgZ1E2xhhzVUpRNsYYY8zLY1E2xhhjLoJF2RhjjLkIFmVjjDHmIliUjTHGmItgUTbGGGMugkXZGGOMuQgvLsr6brC+k6z6+N3nR3xvmO8s5z4r9J3p7jva0I3h7myNfesaHZkX2uDPsbKbGn2Xn2vBnHv+jHkbtKLMpqsNWHQ/0rGHrY2bPs4WZTYw+uQY6+knj+mlRVn9dXOtvqJtyu05rIwdumt0dF6It7dNnhfOqYs+Eq4YO6/rONbJJqqYOZe4piZbtOfxT+3IK46X8t75M8Zck1GU8wbyEtBnteEfhY2KDasaSzVG+W8J09lUeU65P4LVsZ99jWDPeqvypH3MST7UcaQsm+herHW2KqbqlLvElNwmG2WOlPlFvJjjVkx+Ez7nleuMMfdktyizMbABsGnwxMA/kYhPDtpQ9Ao/bjbEU33cQCP4VDZtTF27DvKNOUDMI0Js5c+46I96jnoqmcaQxx7bbaG2cc4rYViBWPGfecRc1A82+WvOt8ae/XOdxl1dI/qTHeI4gTHmfyDSgQ++cV5yTpQZyy+//PJ0ZGyyiSrOZKtiao5j3splslHHkRiKqxy3YsZxRjvoGlZzPdm26K4fOWqtQJyXaZ/I8Y0x/+OQKHPzaXPghtSGypGbTxuZNoEch3K1sUw23fxdu45uHJ1NObOBMI49Y+hyX6HqJ+cS/SeqduQFsnH95K+8p3byjf6xbrLR19YYqrwm6EPCRVziqy1lrUvqiEv8HGOPrYtZxVDdZIt1zFmsm9oxbs6jGFLPCwXNfZx/zqnXeWeboL/q+pEffSuGysSlzbRPxDjGmL/Z9TdlbjDQhqGbmg2iu9m0UWzVrdj2ok2CnCu78o91VZvVMVAnoYj1K+QNLkKdrkFlz1RjiNetG1/XLo9J/ipHsm0aV4Z2K36C3JiTLBgxThw3ZeUT17TaTbYupsRRvipjn2zKB4gb67p22PU2tfLBh3OOEj38FVt+k03lCs1J5Uef5BVjqh9sGpP6wc+ibMzMoSfl6WYDNkltbIBfjEGbXLdi2wt5xc0tU41Rm1BsU+XU5Umdxp1jT0ybn9Dcbs1PNQbOtbF346ts2mTjxtuNvbJtXYPIFDeDH7mSM7E135yrHr9cjmi8tJtsWzHVPzBW3i3SOCaboI+cY9UOO225Jvgzt7RVjtW1wh/7ZFO5Yrp+1OW81U+0qR9iaZ+IcYwxf3OqKOsGju04xy/GqOpWbHshR3KtNhSoxli12TsGqOZiQv1u+WPX/Fd2qMYQr1s3vq122V/lSLZVMTtotzV+YFNnbuPmTnzqiCExy1Q5rIzlSMxuHJWNcp7jDD6sKc2l7jdyo4x9Et7JpnLFdP2oY85jTNVx1JjUD34WZWNmHiLKuoG5+aonO9rkui2bYnftOpRjZaM+b4bVJlTlNI0BFKfrO7PiL5+tOchj0NwRO/eDD+JCzNyuy4lyl0Nloy5v3pnc94TWVfSlT9oTJ/riU9VDXq+rtikmY91rm9pkO+Okf4kbOfL3ZN7WzjnTjmvLcbKpH81rzgUf2ubrp5iKQRvaUo5zRM7U4W9RNmZm19+UV242yvLnhuXrHvjpho3xYMumfLQBxLoVyLfaUCD3G3PR5gWM6cgYVnLtYmquc/3RmMSTXZsv9fh9/PixHYPa7R27bOozrguI+QA56YVdrO/Ic0P/5FH5yVblqes82TJTzDjmPTahuFU76hHfn3766cnONeTaRZ84L9SB5nqyQSfK0F0/3ZcxLvVxjtRP3CdibGPM37Si/FbQBhc3n7eOxtyJyhXJAmFq9s7T5O85N+Z6vHlRBl6Z82r+vbxCv5soIwzV05n5N3kt8/TJ03L2ExZlY+7FuxBliG+nVfa3xJ1EGVEh19W3rc0/34aG6TpblI25F+9GlI0xxpirY1E2xhhjLoJF2RhjjLkIFmVjjDHmItxSlPd8QEXfo7zzh7xWx5Dn5S2M/Uzu9AG4zGt/YOu9ryWtnbuM3x/iuy+tKF/508oW5drPojzDHDAXd/u0Ml9/6n5YZbKdydG19FbEQWvnDvfSS60J8xjevCi/JzwvM3cVZfrs+p1sV8Br8uW5+powM4dEWa+a9T3J6JdtwE/38eptsmnDVD03s/rLNlhZdPh08fi5QsaofDiuvLLMucSxZ9sZMbsxVO1A87KnnfqDbl6qvkACdyRmzKkir5fnxlSO/Mel3C7OV0Si0tm2clGfapPz1BjzNYr27qcpK5vyjTl31yj2qTxkA92be9aSxjfNGe26PDWPxFAfVV1mug6TjTpsjIHxsjbiT43GsYHq1Wc19pxbBh/lkWNO1y+3A12jGLtbL+Ye7BZlLUQWTSzHm03nLAwWjRbVqi33EW0qy7YCvrG94mtB5/4muGm14HO73M8qU0xRxaYc6zhfadf1t2deuG4x7hkxI9lPZfp8bsypXTWHky3HlJ/mBn+dV2ij7Xym9pWNMpu16vEhP/KkTvV57NHGOBiP7k1R9TflB9jUR66v8tR8xL7xmfqA6dpO14h+yEPrmb7xqYRNORJP5a28MnneVVYcjivXb881MvdityhTz8Ll5lGdFnG+oeIC3LJxHmOq/xhbNhadFvUKeaGqb+VS+awS23Ge5+YIVS65bnVeqlgZ+azOS3W9MntjZvDv1tnRmCvtOKdO5Uhlq2JyTh02/I+uiSr2lo0c1TfluE6oj3koT+q6e1O+kOdKddP4uvmc8oz9UKYee2yfqeZDcSqbxq4jPsq16xNbzJny3mtLf926pm6al61rVI3T3I9DopzrtXC0KHRDUc9C4jjZgFd9vEKM4I9Ni1L96eZReQt81S9Uizf7dFS5xnacq341x62YkPNbnZdqXF1/q/NCOd/4z42ZWVlne2OutOOcOpUjla2KyXnceGmnOeliV1RzsGXr8q+uDygGR80Dvro3Y4w8V2IaX5dPVw+6zswf46z6zEzXdrpGcR6VE/3SfzV++aqONt3YK2J/qovj7eZFY9BcVNeoim3uxylPyrEuLtK8UDtbXJTyFZWtW7gd+GoxgxY4eXc+FeTAOGPfXbvKt2I1Zq5bnZfcbupvZV6wxTI8N2ZFXFO57mjMlXacx3FEKlsVk3PqsEXfap4m9uYy1U/3GNCuujcj1OGX60U1vr15QpxT/OLcdkzXdrpGOuKjnBgHcxUFT/HkG+th9drSX7euqZvmBdt0jaa25j7sFuW8+LTgKe8VV6EYLKpsU3/kQ5l+uk2jA98YW/0pZuVTkXNhTDx9VO3ivGRbZDVmzm91Xrbaxf625qW7hs+J2aGYGk+cz6MxV9pRxgdf1U22HDPnHZFvtMk/597N9ZaNOFPf1RxN8SLEnea4Gh/nec6gy1Mwn8wLH8LKbbW+Ylz1XV3bbIvXiDrFUU7YmQ/6USzFq8YC6iOOqcoz9l216+Zl6xqt2HMu5pqMohxflYEuqBaW6uONynlsA3HBdTYtzsoWc9GirRZupIqn9rJVN3CMUYGfYjEHnz59+kfM3FcVI7MnJihuNy9b7bb6q+blETFV7ujW2dGYK+3yOLdsuQ6IWflDzlFjzPXTeCYb9eo/M+VKu1gvW9UG8F8ZX/aRfcoTNC+VTyUw6md17Sou/oqjnOh7S5SrmHnsnRBu7Z/VmGWL/YF8Oeb+Ixbl+9CK8hG48PnVGnUswC2b6oy5E9qcoxg8l04UtmxHueK9eeY4z7pGW8L3SKZr9Ig1YV6PU0WZRa9FojoWMnWTLdYZcyceIcovzRXvTcTvLAE84xoxD8wH81LZH433z/fDqaIM+S2WuGgmmzF35C2IMlzl3lQezClzW/ns5eg14smTt3w1J2e9SDiK98/3wemibIwxxphjWJSNMcaYi2BRNsYYYy6CRdkYY4y5CBZlY4wx5iJYlI0xxpiLYFE2xhhjLoJF2RhjjLkIFmVjjDHmEnz49l+559+X6HbmIwAAAABJRU5ErkJggg=="></li> <li>npm publish
<img src="/blog/assets/img/125.06cde755.png"> <img src="data:image/png;base64,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"></li></ol> <hr> <p><strong>没有发布成功走下面3,4,5步</strong>
3. npm config get registry
4. npm config set registry=http://registry.npmjs.org/
5. npm publish
6. 代码更新，重新publish，需要更新版本号
<img src="data:image/png;base64,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"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;library.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span> <span class="token string">&quot;umd&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> calc <span class="token keyword">from</span> <span class="token string">&quot;./calc.js&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 计算</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> methods <span class="token keyword">from</span> <span class="token string">&quot;./methods.js&quot;</span><span class="token punctuation">;</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  calc<span class="token punctuation">,</span> methods
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>calc<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// 加</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 减</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 乘</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">multi</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 除</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">division</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>methods<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">concat</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;assets-router-plugin&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 每次发布都需要修改版本</span>
  <span class="token string-property property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;通过路由配置，支持动态加载js&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist/libraray.js&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 入口文件,对应output.filename</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.43.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.2&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;alan89757&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MIT&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>测试自己发布的库<code>assets-router-plugin</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>app<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> result <span class="token keyword">from</span> <span class="token string">&quot;assets-router-plugin&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// es6的import引入</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 6  亲测成功亲测成功</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> assetsrouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;assets-router-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// commonjs引入自己发布的库</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>assetsrouter<span class="token punctuation">.</span>default<span class="token punctuation">.</span>calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 8 亲测成功</span>

</code></pre></div><p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/use-myplugin" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="编写webpack-loader"><a href="#编写webpack-loader" class="header-anchor">#</a> 编写webpack loader</h4> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/use-myloader" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../my-loader/loader.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 加载自定义的loader</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;alan&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>  
        <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>main<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>loader<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// 自定义loader</span>
<span class="token comment">//loader支持的api  https://v4.webpack.js.org/api/loaders/   </span>
<span class="token comment">// 同步loader</span>
<span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span>loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取options参数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;alan&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>loaderAsync<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// 异步loader</span>
<span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span>loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 异步回调</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;alan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// loader直接配置字符串，需要配置resolveLoader.modules支持loader查找</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../my-loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;loaderAsync&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 需要配置resolveLoader.modules</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="编写webpack-plugin"><a href="#编写webpack-plugin" class="header-anchor">#</a> 编写webpack plugin</h4> <p><a href="https://github.com/alan89757/webpack-analysis/tree/master/src/use-myplugin" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../my-plugin/copy-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 自定义的插件</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>copy<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// 自定义webpack插件</span>
<span class="token keyword">class</span> <span class="token class-name">CopyWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// compiler是webpack运行实例</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;CopyWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello world_____&quot;</span><span class="token punctuation">)</span>
      compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">&quot;copy.txt&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token string">&quot;hello alan&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token number">100</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;CopyWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;同步钩子...&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyWebpackPlugin<span class="token punctuation">;</span>
</code></pre></div><ul><li>node调试</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">scripts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --inspect --inspect-brk node_modules/webpack/bin/webpack.js --config ./src/use-myplugin/webpack.config.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="写自己的-webpack-bundle"><a href="#写自己的-webpack-bundle" class="header-anchor">#</a> 写自己的&quot;webpack&quot; (bundle)</h4> <p>bundle-demo项目文件目录如下：
├── README.md
├── src
│   └── index.js
│   └── message.js
│   └── news.js
├── package-lock.json
├── package.json
├── bundle.config.js</p> <p>bundle项目文件目录如下：
├── README.md
├── bin
│   └── bundle.js
├── package-lock.json
├── package.json</p> <h4 id="实现bundle打包步骤如下"><a href="#实现bundle打包步骤如下" class="header-anchor">#</a> 实现bundle打包步骤如下</h4> <ol><li>新建bundle文件夹</li> <li>在bin目录下新建bundle.js</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>bundle<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;bunlde脚本执行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ol start="3"><li>npm init -y, 修改bin目录</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">package</span><span class="token punctuation">.</span>json<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;bundle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/bundle.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li><p>把包发到npmjs.org，或者npm link(把bundle添加软链接到全局), 效果图如下：
<img src="/blog/assets/img/128.dccaffef.png"> <img src="/blog/assets/img/129.26b82768.png"></p></li> <li><p>读取bundle.config.js配置</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>bundle<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
  #<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;bunlde脚本执行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;bundle.config.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 读取bundle.config.js</span>
<span class="token keyword">const</span> Compiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../lib/compiler.js&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Compiler</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>bundle<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;app.js&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>index<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./message.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>message<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> news <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./news.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&quot;今天天气 &quot;</span><span class="token operator">+</span> news<span class="token punctuation">.</span>content
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>news<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&quot;下雪22&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><ol start="6"><li>编译类Compiler</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>compiler<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/parser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 用来转换抽象语法树AST</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/traverse&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>  <span class="token comment">// require替换成__webpack_require__</span>
<span class="token keyword">const</span> generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/generator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>  <span class="token comment">// 读取代码内容</span>
<span class="token keyword">const</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// ejs模板</span>
<span class="token keyword">class</span> <span class="token class-name">Compiler</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entry <span class="token operator">=</span> config<span class="token punctuation">.</span>entry<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>root <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>modules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 读取代码</span>
    <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token parameter">filepath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filepath<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 分析模块代码</span>
    <span class="token function">depAnalyes</span><span class="token punctuation">(</span><span class="token parameter">modulePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//2.  获得入口文件内容</span>
        <span class="token keyword">let</span> source <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// 依赖数组</span>
        <span class="token comment">// 3. 分析内容引入其他模块，使用@babel/parser转换成抽象语法树AST</span>
        <span class="token comment">//  查看AST抽象语法树地址：https://astexplorer.net/</span>
        <span class="token keyword">let</span> <span class="token constant">AST</span> <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4. 找到代码require替换成__webpack_require__, type=CallExpression有require, @babel/traverse</span>
        <span class="token function">traverse</span><span class="token punctuation">(</span><span class="token constant">AST</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">CallExpression</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;require&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;__webpack_require__&quot;</span><span class="token punctuation">;</span>
                    <span class="token comment">// 6.更改require中的路径</span>
                    <span class="token keyword">let</span> val <span class="token operator">=</span> p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">+</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;./src&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 7. 根据路径去加载路径下的内容，分析文件内容，将这个路径push到一个数组中</span>
                    dependencies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log(dependencies)</span>
        <span class="token comment">// 8. 递归所有依赖</span>
        dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dep</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> newPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// console.log(newPath)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">depAnalyes</span><span class="token punctuation">(</span>newPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 9. 希望构建结果{&quot;./src/index.js&quot;: &quot;code...&quot;} </span>
        <span class="token keyword">let</span> relativePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        relativePath <span class="token operator">=</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">+</span> relativePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">[</span>relativePath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token constant">AST</span><span class="token punctuation">)</span><span class="token punctuation">.</span>code<span class="token punctuation">;</span>
        <span class="token comment">// console.log(this.modules)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 替换模板文件</span>
    <span class="token function">emitFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../template/template.ejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entry<span class="token punctuation">,</span>
            <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modules
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> outputPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// console.log(outputPath);</span>
        <span class="token comment">// console.log(result);</span>
        <span class="token comment">// 写入文件</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token comment">// 编译入口</span>
    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// console.log(this.root, this.entry)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">depAnalyes</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emitFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span>  Compiler<span class="token punctuation">;</span>

<span class="token comment">// 模板文件</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>template<span class="token punctuation">.</span>ejs<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
 <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// webpackBootstrap</span>
 	<span class="token comment">// The module cache</span>
 	<span class="token keyword">var</span> installedModules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

 	<span class="token comment">// The require function</span>
 	<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

 		<span class="token comment">// Check if module is in cache</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 			<span class="token keyword">return</span> installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
 		<span class="token comment">// Create a new module (and put it into the cache)</span>
 		<span class="token keyword">var</span> module <span class="token operator">=</span> installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
 			<span class="token literal-property property">i</span><span class="token operator">:</span> moduleId<span class="token punctuation">,</span>
 			<span class="token literal-property property">l</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
 			<span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 		<span class="token punctuation">}</span><span class="token punctuation">;</span>

 		<span class="token comment">// Execute the module function</span>
 		modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>

 		<span class="token comment">// Flag the module as loaded</span>
 		module<span class="token punctuation">.</span>l <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

 		<span class="token comment">// Return the exports of the module</span>
 		<span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>

 	<span class="token comment">// expose the modules object (__webpack_modules__)</span>
 	__webpack_require__<span class="token punctuation">.</span>m <span class="token operator">=</span> modules<span class="token punctuation">;</span>

 	<span class="token comment">// expose the module cache</span>
 	__webpack_require__<span class="token punctuation">.</span>c <span class="token operator">=</span> installedModules<span class="token punctuation">;</span>

 	<span class="token comment">// define getter function for harmony exports</span>
 	__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> name<span class="token punctuation">,</span> getter</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>__webpack_require__<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 			Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">get</span><span class="token operator">:</span> getter <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
 	<span class="token punctuation">}</span><span class="token punctuation">;</span>

 	<span class="token comment">// define __esModule on exports</span>
 	__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Symbol <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 			Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'Module'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
 		Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token punctuation">}</span><span class="token punctuation">;</span>

 	__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">t</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> mode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> value <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span>__esModule<span class="token punctuation">)</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span>
 		<span class="token keyword">var</span> ns <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		__webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">;</span>
 		Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>ns<span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> value <span class="token operator">!=</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> value<span class="token punctuation">)</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>ns<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> value<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">return</span> ns<span class="token punctuation">;</span>
 	<span class="token punctuation">}</span><span class="token punctuation">;</span>

 	<span class="token comment">// getDefaultExport function for compatibility with non-harmony modules</span>
 	__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">n</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">var</span> getter <span class="token operator">=</span> module <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>__esModule <span class="token operator">?</span>
 			<span class="token keyword">function</span> <span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> module<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">:</span>
 			<span class="token keyword">function</span> <span class="token function">getModuleExports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> module<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
 		__webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>getter<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> getter<span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">return</span> getter<span class="token punctuation">;</span>
 	<span class="token punctuation">}</span><span class="token punctuation">;</span>

 	<span class="token comment">// Object.prototype.hasOwnProperty.call</span>
 	__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">o</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> property<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

 	<span class="token comment">// __webpack_public_path__</span>
 	__webpack_require__<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>


 	<span class="token comment">// Load entry module and return exports</span>
 	<span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token string">&quot;&lt;%-entry%&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/************************************************************************/</span>
 <span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> modules<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">%</span><span class="token operator">&gt;</span> 
<span class="token string-property property">&quot;&lt;%-key%&gt;&quot;</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;%-modules[key]%&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span> 
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><a href="https://babeljs.io/docs/en/babel-parser" target="_blank" rel="noopener noreferrer">代码转成抽象语法树AST @babel/parser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://babeljs.io/docs/en/babel-traverse" target="_blank" rel="noopener noreferrer">require替换成__webpack_require__ @babel/traverse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://babeljs.io/docs/en/babel-generator#docsNav" target="_blank" rel="noopener noreferrer">AST树转换为code @babel/generator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.npmjs.com/package/ejs" target="_blank" rel="noopener noreferrer">模板文件 ejs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="webpack的loader实现步骤"><a href="#webpack的loader实现步骤" class="header-anchor">#</a> webpack的loader实现步骤</h4> <ul><li>读取配置文件webpack.config.js中的module.rules，倒序迭代</li> <li>根据正则匹配不同的文件，批量导入并执行loader函数</li> <li>返回处理后的代码</li></ul> <h4 id="webpack的plugin实现步骤"><a href="#webpack的plugin实现步骤" class="header-anchor">#</a> webpack的plugin实现步骤</h4> <ul><li>写一个js命名的函数，然后导出该函数</li> <li>在插件函数原型上定义apply方法</li> <li>指定一个绑定到webpack自身的事件钩子</li> <li>处理webpack内部实例的特定数据</li> <li>功能完成后调用webpack提供的回调</li></ul> <p>webpack借助tapable（类似node中event模块）实现了钩子</p> <h3 id="完整的demo"><a href="#完整的demo" class="header-anchor">#</a> 完整的demo</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>bundle<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
<span class="token comment">// console.log(&quot;bunlde脚本执行&quot;);</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;bundle.config.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// console.log(config);  // 读取bundle.config.js</span>

<span class="token keyword">const</span> Compiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../lib/compiler.js&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// 编译类</span>
<span class="token comment">// console.log(Compiler)</span>

<span class="token keyword">new</span> <span class="token class-name">Compiler</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>compiler<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/parser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 用来转换抽象语法树AST</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/traverse&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>  <span class="token comment">// require替换成__webpack_require__</span>
<span class="token keyword">const</span> generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/generator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>  <span class="token comment">// 读取代码内容</span>
<span class="token keyword">const</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// ejs模板</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> SyncHook <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;tapable&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Compiler</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span>   <span class="token comment">// 配置文件</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entry <span class="token operator">=</span> config<span class="token punctuation">.</span>entry<span class="token punctuation">;</span>  <span class="token comment">// 入口文件</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>root <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 获取执行根目录</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>modules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">// 存储数据结构：{&quot;./src/index.js&quot;: &quot;code...&quot;} </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rules <span class="token operator">=</span> config<span class="token punctuation">.</span>module<span class="token punctuation">.</span>rules<span class="token punctuation">;</span>   <span class="token comment">// 存储loaders</span>

        <span class="token comment">// 初始化生命周期钩子</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">compile</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">afterCompile</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">emit</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">afterEmit</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 执行plugin</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">plugin</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 读取代码</span>
    <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token parameter">filepath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filepath<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 分析模块代码</span>
    <span class="token function">depAnalyes</span><span class="token punctuation">(</span><span class="token parameter">modulePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//2.  获得入口文件内容</span>
        <span class="token keyword">let</span> source <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 读取rules（webpack的loader）</span>
        <span class="token keyword">let</span> rulesLength <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> rulesLength <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token punctuation">{</span> test<span class="token punctuation">,</span> use <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 判断use是否数组</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>use <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 数组  // {test: /\.js$/, use: [ &quot;babel-loader&quot;, &quot;ts-loader&quot; ] }</span>
                    <span class="token keyword">let</span> useLength <span class="token operator">=</span> use<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> useLength <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// console.log(path.join(this.root, use[j]))</span>
                        <span class="token keyword">let</span> loader <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> use<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        source <span class="token operator">=</span> <span class="token function">loader</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>                 
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> use <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 字符串</span>
                    <span class="token keyword">let</span> loader <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> use<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//{test: /\.js$/, use: &quot;babel-loader&quot;}</span>
                    source <span class="token operator">=</span> <span class="token function">loader</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> use <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> loader <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> use<span class="token punctuation">.</span>loader<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// {test: /\.js$/, use: { loader: &quot;babel-loader&quot;} }</span>
                    source <span class="token operator">=</span> <span class="token function">loader</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">let</span> dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// 依赖数组</span>
        <span class="token comment">// 3. 分析内容引入其他模块，使用@babel/parser转换成抽象语法树AST,</span>
        <span class="token comment">//  查看AST抽象语法树地址：https://astexplorer.net/</span>
        <span class="token keyword">let</span> <span class="token constant">AST</span> <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4. 找到代码require替换成__webpack_require__, type=CallExpression有require, @babel/traverse</span>
        <span class="token function">traverse</span><span class="token punctuation">(</span><span class="token constant">AST</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">CallExpression</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;require&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;__webpack_require__&quot;</span><span class="token punctuation">;</span>
                    <span class="token comment">// 6.更改require中的路径</span>
                    <span class="token keyword">let</span> val <span class="token operator">=</span> p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">+</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;./src&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 7. 根据路径去加载路径下的内容，分析文件内容，将这个路径push到一个数组中</span>
                    dependencies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log(dependencies)</span>
        <span class="token comment">// 8. 递归所有依赖</span>
        dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dep</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> newPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// console.log(newPath)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">depAnalyes</span><span class="token punctuation">(</span>newPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 9. 希望构建结果{&quot;./src/index.js&quot;: &quot;code...&quot;} </span>
        <span class="token keyword">let</span> relativePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        relativePath <span class="token operator">=</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">+</span> relativePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">[</span>relativePath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token constant">AST</span><span class="token punctuation">)</span><span class="token punctuation">.</span>code<span class="token punctuation">;</span>  <span class="token comment">// AST转换成code</span>
        <span class="token comment">// console.log(this.modules)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 替换模板文件</span>
    <span class="token function">emitFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../template/template.ejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entry<span class="token punctuation">,</span>
            <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modules
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> outputPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// console.log(outputPath);</span>
        <span class="token comment">// console.log(result);</span>
        <span class="token comment">// 写入文件</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token comment">// 编译入口</span>
    <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// console.log(this.root, this.entry)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">depAnalyes</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emitFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">afterEmit</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span>  Compiler<span class="token punctuation">;</span>


<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>bundle<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./plugins/copy-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 自定义组件</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">// {</span>
            <span class="token comment">//     test: /\.js/,</span>
            <span class="token comment">//     use: [</span>
            <span class="token comment">//         &quot;./loaders/loader1.js&quot;,</span>
            <span class="token comment">//         &quot;./loaders/loader2.js&quot;,</span>
            <span class="token comment">//         &quot;./loaders/loader3.js&quot;</span>
            <span class="token comment">//     ]</span>
            <span class="token comment">// }</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;app.js&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>copy<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">class</span> <span class="token class-name">CopyWebpackPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//   console.log(options)</span>
    <span class="token punctuation">}</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// compiler是webpack运行实例</span>
        <span class="token comment">// 同步</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;CopyWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            compilation<span class="token punctuation">.</span>aabb <span class="token operator">=</span> <span class="token string">&quot;hello alan&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 异步</span>
        <span class="token comment">/*
      compiler.hooks.emit.tapAsync(&quot;CopyWebpackPlugin&quot;, function(compilation) {
        console.log(&quot;hello world_____&quot;)
        compilation.assets[&quot;copy.txt&quot;] = {
          source: function() {
            return &quot;hello alan&quot;;
          },
          size: function() {
            return 100
          }
        }
        cb();
      })
      */</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyWebpackPlugin<span class="token punctuation">;</span>


</code></pre></div></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h3 active"><a href="#对比-webpack-gulp-grunt" title="对比 webpack gulp grunt">对比 webpack gulp grunt</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#模块化" title="模块化">模块化</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#webpack-4-x" title="webpack 4.x">webpack 4.x</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#webpack-常用命令" title="webpack 常用命令">webpack 常用命令</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#webpack初始化项目" title="webpack初始化项目">webpack初始化项目</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#webpack多入口打包" title="webpack多入口打包">webpack多入口打包</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#webpack基本配置" title="webpack基本配置">webpack基本配置</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#es6-转es5语法" title="ES6+转es5语法">ES6+转es5语法</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#支持ts" title="支持ts">支持ts</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#hmr-热模块更新" title="HMR(热模块更新)">HMR(热模块更新)</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#代码分割-代码分割和webpack无关-用来提升性能" title="代码分割（代码分割和webpack无关，用来提升性能）">代码分割（代码分割和webpack无关，用来提升性能）</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#完整的demo" title="完整的demo">完整的demo</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.d377f9a8.js" defer></script><script src="/blog/assets/js/13.cdda75ce.js" defer></script><script src="/blog/assets/js/3.6e92e369.js" defer></script><script src="/blog/assets/js/10.d7440df3.js" defer></script>
  </body>
</html>
